{"version":3,"file":"node-build.mjs","sources":["../../server/routes/demo.ts","../../server/routes/platforms.ts","../../server/bot/telegram-bot.ts","../../server/index.ts","../../server/node-build.ts"],"sourcesContent":["import { RequestHandler } from \"express\";\nimport { DemoResponse } from \"@shared/api\";\n\nexport const handleDemo: RequestHandler = (req, res) => {\n  const response: DemoResponse = {\n    message: \"Hello from Express server\",\n  };\n  res.status(200).json(response);\n};\n","import { Router } from 'express';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst router = Router();\r\n\r\n// Path to store platform links data\r\nconst DATA_FILE = path.join(process.cwd(), 'data', 'platform-links.json');\r\n\r\n// Ensure data directory exists\r\nfunction ensureDataDir() {\r\n  const dataDir = path.dirname(DATA_FILE);\r\n  if (!fs.existsSync(dataDir)) {\r\n    fs.mkdirSync(dataDir, { recursive: true });\r\n  }\r\n}\r\n\r\n// Read platform links from file\r\nfunction readPlatformLinks(): Record<string, { web: string; ios: string; android: string; androidFileName?: string }> {\r\n  ensureDataDir();\r\n  try {\r\n    if (fs.existsSync(DATA_FILE)) {\r\n      const data = fs.readFileSync(DATA_FILE, 'utf-8');\r\n      return JSON.parse(data);\r\n    }\r\n  } catch (error) {\r\n    console.error('Error reading platform links:', error);\r\n  }\r\n  return {};\r\n}\r\n\r\n// Write platform links to file\r\nfunction writePlatformLinks(data: Record<string, { web: string; ios: string; android: string; androidFileName?: string }>) {\r\n  ensureDataDir();\r\n  try {\r\n    fs.writeFileSync(DATA_FILE, JSON.stringify(data, null, 2), 'utf-8');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error writing platform links:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// GET all platform links\r\nrouter.get('/api/platform-links', (req, res) => {\r\n  const links = readPlatformLinks();\r\n  res.json(links);\r\n});\r\n\r\n// GET specific platform links\r\nrouter.get('/api/platform-links/:platformId', (req, res) => {\r\n  const links = readPlatformLinks();\r\n  const platformLinks = links[req.params.platformId];\r\n\r\n  if (platformLinks) {\r\n    res.json(platformLinks);\r\n  } else {\r\n    res.status(404).json({ error: 'Platform not found' });\r\n  }\r\n});\r\n\r\n// POST/PUT update platform links (requires admin authentication)\r\nrouter.post('/api/platform-links/:platformId', (req, res) => {\r\n  const { platformId } = req.params;\r\n  const { web, ios, android, adminKey } = req.body;\r\n\r\n  // Simple admin key check (you should use proper authentication)\r\n  const ADMIN_KEY = process.env.ADMIN_KEY || 'change-this-in-production';\r\n\r\n  if (adminKey !== ADMIN_KEY) {\r\n    return res.status(403).json({ error: 'Unauthorized' });\r\n  }\r\n\r\n  const links = readPlatformLinks();\r\n  links[platformId] = { web, ios, android };\r\n\r\n  if (writePlatformLinks(links)) {\r\n    res.json({ success: true, platformId, links: links[platformId] });\r\n  } else {\r\n    res.status(500).json({ error: 'Failed to update platform links' });\r\n  }\r\n});\r\n\r\n// DELETE platform links (requires admin authentication)\r\nrouter.delete('/api/platform-links/:platformId', (req, res) => {\r\n  const { platformId } = req.params;\r\n  const { adminKey } = req.body;\r\n\r\n  const ADMIN_KEY = process.env.ADMIN_KEY || 'change-this-in-production';\r\n\r\n  if (adminKey !== ADMIN_KEY) {\r\n    return res.status(403).json({ error: 'Unauthorized' });\r\n  }\r\n\r\n  const links = readPlatformLinks();\r\n\r\n  if (links[platformId]) {\r\n    delete links[platformId];\r\n\r\n    if (writePlatformLinks(links)) {\r\n      res.json({ success: true, platformId });\r\n    } else {\r\n      res.status(500).json({ error: 'Failed to delete platform links' });\r\n    }\r\n  } else {\r\n    res.status(404).json({ error: 'Platform not found' });\r\n  }\r\n});\r\n\r\nexport default router;\r\n","import TelegramBot from 'node-telegram-bot-api';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\n// Configuration\r\nconst BOT_TOKEN = process.env.TELEGRAM_BOT_TOKEN || '';\r\nconst ADMIN_USERS = (process.env.TELEGRAM_ADMIN_IDS || '').split(',').map(id => parseInt(id.trim()));\r\n\r\n// Data file path\r\nconst DATA_FILE = path.join(process.cwd(), 'data', 'platform-links.json');\r\n\r\n// Ensure data directory exists\r\nfunction ensureDataDir() {\r\n  const dataDir = path.dirname(DATA_FILE);\r\n  if (!fs.existsSync(dataDir)) {\r\n    fs.mkdirSync(dataDir, { recursive: true });\r\n  }\r\n}\r\n\r\n// Read platform links\r\nfunction readPlatformLinks(): Record<string, { web: string; ios: string; android: string; androidFileName?: string }> {\r\n  ensureDataDir();\r\n  try {\r\n    if (fs.existsSync(DATA_FILE)) {\r\n      const data = fs.readFileSync(DATA_FILE, 'utf-8');\r\n      return JSON.parse(data);\r\n    }\r\n  } catch (error) {\r\n    console.error('Error reading platform links:', error);\r\n  }\r\n  return {};\r\n}\r\n\r\n// Write platform links\r\nfunction writePlatformLinks(data: Record<string, { web: string; ios: string; android: string; androidFileName?: string }>) {\r\n  ensureDataDir();\r\n  try {\r\n    fs.writeFileSync(DATA_FILE, JSON.stringify(data, null, 2), 'utf-8');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error writing platform links:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Check if user is admin\r\nfunction isAdmin(userId: number): boolean {\r\n  return ADMIN_USERS.includes(userId);\r\n}\r\n\r\n// Platform names\r\nconst PLATFORMS = [\r\n  '1xbet', 'melbet', 'linebet', '888starz', '1xcasino', 'dbbet',\r\n  'winwin', 'mostbet', 'xparibet', 'betwinner', 'megapari', 'coldbet',\r\n  'ultrapari', 'fastpari', 'spinbetter', 'yohohobet', 'luckypari'\r\n];\r\n\r\n// Global bot instance to prevent duplicates\r\nlet botInstance: TelegramBot | null = null;\r\n\r\nexport function stopTelegramBot() {\r\n  if (botInstance) {\r\n    botInstance.stopPolling();\r\n    botInstance = null;\r\n    console.log('Telegram bot stopped');\r\n  }\r\n}\r\n\r\nexport function startTelegramBot() {\r\n  if (botInstance) {\r\n    console.log('Telegram bot already running, skipping initialization');\r\n    return botInstance;\r\n  }\r\n\r\n  if (!BOT_TOKEN || BOT_TOKEN === 'YOUR_NEW_BOT_TOKEN_HERE' || BOT_TOKEN.length < 20) {\r\n    console.warn('WARNING: Telegram bot disabled - Invalid or missing token');\r\n    console.warn('   Get a new token from @BotFather and update .env file');\r\n    return null;\r\n  }\r\n\r\n  const bot = new TelegramBot(BOT_TOKEN, { polling: false });\r\n\r\n  bot.deleteWebHook().then(() => {\r\n    console.log('Webhook deleted, starting polling...');\r\n    bot.startPolling({ restart: true });\r\n    botInstance = bot;\r\n    console.log('Telegram bot started successfully!');\r\n  }).catch(err => {\r\n    console.error('Error deleting webhook:', err);\r\n    bot.startPolling({ restart: true });\r\n    botInstance = bot;\r\n  });\r\n\r\n  bot.on('polling_error', (error) => {\r\n    console.error('Polling error:', error.code);\r\n    if (error.code === 'ETELEGRAM' && error.message.includes('409')) {\r\n      console.log('Conflict detected, stopping old instance...');\r\n      setTimeout(() => {\r\n        bot.stopPolling();\r\n        setTimeout(() => bot.startPolling({ restart: true }), 2000);\r\n      }, 1000);\r\n    }\r\n  });\r\n\r\n  const userState: Record<number, { platform?: string; editType?: 'web' | 'ios' | 'android' }> = {};\r\n\r\n  const getMainMenu = () => ({\r\n    inline_keyboard: [\r\n      [{ text: 'ðŸ“‹ ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð²ÑÐµ ÑÑÑ‹Ð»ÐºÐ¸', callback_data: 'action_list' }],\r\n      [{ text: 'âš™ï¸ Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑÑ‹Ð»ÐºÐ°Ð¼Ð¸', callback_data: 'action_manage' }],\r\n      [{ text: 'ðŸ—‘ Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ñƒ', callback_data: 'action_delete' }],\r\n      [{ text: 'ðŸŽ° Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼', callback_data: 'action_platforms' }],\r\n    ]\r\n  });\r\n\r\n  const getPlatformKeyboard = (action: string) => {\r\n    const keyboard: any[][] = [];\r\n    for (let i = 0; i < PLATFORMS.length; i += 3) {\r\n      const row = PLATFORMS.slice(i, i + 3).map(platform => ({\r\n        text: platform,\r\n        callback_data: `${action}_${platform}`\r\n      }));\r\n      keyboard.push(row);\r\n    }\r\n    keyboard.push([{ text: 'â—€ï¸ ÐÐ°Ð·Ð°Ð´', callback_data: 'back_main' }]);\r\n    return { inline_keyboard: keyboard };\r\n  };\r\n\r\n  const getPlatformEditMenu = (platform: string) => {\r\n    const links = readPlatformLinks();\r\n    const pl = links[platform] || { web: '', ios: '', android: '' };\r\n\r\n    return {\r\n      inline_keyboard: [\r\n        [{ text: 'ðŸŒ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Web', callback_data: `edit_web_${platform}` }],\r\n        [{ text: 'ðŸŽ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ iOS', callback_data: `edit_ios_${platform}` }],\r\n        [{ text: 'ðŸ¤– Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Android APK', callback_data: `edit_android_${platform}` }],\r\n        [{ text: 'ðŸ“‹ ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ðµ', callback_data: `show_${platform}` }],\r\n        [{ text: 'â—€ï¸ ÐÐ°Ð·Ð°Ð´', callback_data: 'action_manage' }],\r\n      ]\r\n    };\r\n  };\r\n\r\n  bot.onText(/\\/start/, (msg) => {\r\n    const chatId = msg.chat.id;\r\n    const userId = msg.from?.id || 0;\r\n    let message = 'ðŸ‘‹ *Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ Ð² LinkZone Admin Bot!*\\n\\n';\r\n\r\n    if (isAdmin(userId)) {\r\n      message += 'ðŸ” Ð’Ñ‹ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½Ñ‹ ÐºÐ°Ðº Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€.\\n\\nÐ’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ:';\r\n      bot.sendMessage(chatId, message, { parse_mode: 'Markdown', reply_markup: getMainMenu() });\r\n    } else {\r\n      message += 'âš ï¸ Ð£ Ð²Ð°Ñ Ð½ÐµÑ‚ Ð¿Ñ€Ð°Ð² Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°.';\r\n      bot.sendMessage(chatId, message, { parse_mode: 'Markdown' });\r\n    }\r\n  });\r\n\r\n  bot.onText(/\\/help/, (msg) => {\r\n    bot.sendMessage(msg.chat.id, 'ðŸ‘‹ Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ /start Ð´Ð»Ñ Ð½Ð°Ñ‡Ð°Ð»Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹', { reply_markup: getMainMenu() });\r\n  });\r\n\r\n  bot.on('callback_query', async (query) => {\r\n    const chatId = query.message!.chat.id;\r\n    const userId = query.from.id;\r\n    const data = query.data!;\r\n    const messageId = query.message!.message_id;\r\n\r\n    if (!isAdmin(userId)) {\r\n      bot.answerCallbackQuery(query.id, { text: 'â›” Ð”Ð¾ÑÑ‚ÑƒÐ¿ Ð·Ð°Ð¿Ñ€ÐµÑ‰ÐµÐ½', show_alert: true });\r\n      return;\r\n    }\r\n\r\n    if (data === 'action_list') {\r\n      const links = readPlatformLinks();\r\n      let message = 'ðŸ“‹ *Ð¢ÐµÐºÑƒÑ‰Ð¸Ðµ ÑÑÑ‹Ð»ÐºÐ¸ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼:*\\n\\n';\r\n      if (Object.keys(links).length === 0) {\r\n        message = 'ðŸ“­ ÐÐµÑ‚ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ñ… ÑÑÑ‹Ð»Ð¾Ðº.';\r\n      } else {\r\n        for (const [platform, urls] of Object.entries(links)) {\r\n          message += `*${platform.toUpperCase()}*\\n`;\r\n          message += `ðŸŒ Web: ${urls.web || 'âŒ'}\\n`;\r\n          message += `ðŸŽ iOS: ${urls.ios || 'âŒ'}\\n`;\r\n          message += `ðŸ¤– Android: ${urls.android || 'âŒ'}\\n\\n`;\r\n        }\r\n      }\r\n      bot.editMessageText(message, {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: { inline_keyboard: [[{ text: 'â—€ï¸ ÐÐ°Ð·Ð°Ð´', callback_data: 'back_main' }]] }\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data === 'action_platforms') {\r\n      let message = 'ðŸŽ° *Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ñ‹:*\\n\\n';\r\n      PLATFORMS.forEach((p, i) => message += `${i + 1}. ${p}\\n`);\r\n      bot.editMessageText(message, {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: { inline_keyboard: [[{ text: 'â—€ï¸ ÐÐ°Ð·Ð°Ð´', callback_data: 'back_main' }]] }\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data === 'action_manage') {\r\n      bot.editMessageText('âš™ï¸ *Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑÑ‹Ð»ÐºÐ°Ð¼Ð¸*\\n\\nÐ’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ñƒ:', {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: getPlatformKeyboard('manage')\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data === 'action_delete') {\r\n      bot.editMessageText('ðŸ—‘ *Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ñƒ*\\n\\nÐ’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ:', {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: getPlatformKeyboard('delete')\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data === 'back_main') {\r\n      delete userState[userId];\r\n      bot.editMessageText('*LinkZone Admin Bot*\\n\\nÐ’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ:', {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: getMainMenu()\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data.startsWith('manage_')) {\r\n      const platform = data.replace('manage_', '');\r\n      const links = readPlatformLinks();\r\n      const pl = links[platform] || { web: '', ios: '', android: '' };\r\n\r\n      let message = `âš™ï¸ *Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ: ${platform.toUpperCase()}*\\n\\n`;\r\n      message += `ðŸŒ Web: ${pl.web || 'âŒ Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾'}\\n`;\r\n      message += `ðŸŽ iOS: ${pl.ios || 'âŒ Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾'}\\n`;\r\n      message += `ðŸ¤– Android: ${pl.android || 'âŒ Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾'}\\n\\n`;\r\n      message += 'Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ‡Ñ‚Ð¾ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ:';\r\n\r\n      bot.editMessageText(message, {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: getPlatformEditMenu(platform)\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data.startsWith('show_')) {\r\n      const platform = data.replace('show_', '');\r\n      const links = readPlatformLinks();\r\n      const pl = links[platform] || { web: '', ios: '', android: '' };\r\n\r\n      let message = `ðŸ“‹ *${platform.toUpperCase()} - Ð¢ÐµÐºÑƒÑ‰Ð¸Ðµ ÑÑÑ‹Ð»ÐºÐ¸:*\\n\\n`;\r\n      message += `ðŸŒ Web:\\n\\`${pl.web || 'Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾'}\\`\\n\\n`;\r\n      message += `ðŸŽ iOS:\\n\\`${pl.ios || 'Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾'}\\`\\n\\n`;\r\n      message += `ðŸ¤– Android:\\n\\`${pl.android || 'Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾'}\\``;\r\n\r\n      bot.editMessageText(message, {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: { inline_keyboard: [[{ text: 'â—€ï¸ ÐÐ°Ð·Ð°Ð´', callback_data: `manage_${platform}` }]] }\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data.startsWith('edit_web_')) {\r\n      const platform = data.replace('edit_web_', '');\r\n      userState[userId] = { platform, editType: 'web' };\r\n      bot.editMessageText(`ðŸŒ *Web ÑÑÑ‹Ð»ÐºÐ° Ð´Ð»Ñ ${platform.toUpperCase()}*\\n\\nÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ ÑÑÑ‹Ð»ÐºÑƒ:`, {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: { inline_keyboard: [[{ text: 'âŒ ÐžÑ‚Ð¼ÐµÐ½Ð°', callback_data: `manage_${platform}` }]] }\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data.startsWith('edit_ios_')) {\r\n      const platform = data.replace('edit_ios_', '');\r\n      userState[userId] = { platform, editType: 'ios' };\r\n      bot.editMessageText(`ðŸŽ *iOS ÑÑÑ‹Ð»ÐºÐ° Ð´Ð»Ñ ${platform.toUpperCase()}*\\n\\nÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ ÑÑÑ‹Ð»ÐºÑƒ:`, {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: { inline_keyboard: [[{ text: 'âŒ ÐžÑ‚Ð¼ÐµÐ½Ð°', callback_data: `manage_${platform}` }]] }\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data.startsWith('edit_android_')) {\r\n      const platform = data.replace('edit_android_', '');\r\n      userState[userId] = { platform, editType: 'android' };\r\n      bot.editMessageText(`ðŸ¤– *Android APK Ð´Ð»Ñ ${platform.toUpperCase()}*\\n\\nÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ ÑÑÑ‹Ð»ÐºÑƒ Ð½Ð° APK:`, {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: { inline_keyboard: [[{ text: 'âŒ ÐžÑ‚Ð¼ÐµÐ½Ð°', callback_data: `manage_${platform}` }]] }\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data.startsWith('delete_')) {\r\n      const platform = data.replace('delete_', '');\r\n      const links = readPlatformLinks();\r\n      if (links[platform]) {\r\n        delete links[platform];\r\n        if (writePlatformLinks(links)) {\r\n          bot.editMessageText(`âœ… ÐŸÐ»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð° *${platform}* ÑƒÐ´Ð°Ð»ÐµÐ½Ð°!`, {\r\n            chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n            reply_markup: { inline_keyboard: [[{ text: 'â—€ï¸ ÐÐ°Ð·Ð°Ð´', callback_data: 'back_main' }]] }\r\n          });\r\n        } else {\r\n          bot.answerCallbackQuery(query.id, { text: 'âŒ ÐžÑˆÐ¸Ð±ÐºÐ°', show_alert: true });\r\n        }\r\n      } else {\r\n        bot.answerCallbackQuery(query.id, { text: `âš ï¸ ÐÐµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°`, show_alert: true });\r\n      }\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n  });\r\n\r\n  bot.on('message', async (msg) => {\r\n    const chatId = msg.chat.id;\r\n    const userId = msg.from?.id || 0;\r\n    const text = msg.text || '';\r\n\r\n    if (text.startsWith('/')) return;\r\n\r\n    const state = userState[userId];\r\n    if (!state || !state.platform || !state.editType) return;\r\n\r\n    let linkToSave = '';\r\n    let fileName = '';\r\n\r\n    // Check if user sent a document (APK file)\r\n    if (msg.document) {\r\n      try {\r\n        // Get file link from Telegram\r\n        const fileLink = await bot.getFileLink(msg.document.file_id);\r\n        linkToSave = fileLink;\r\n        fileName = msg.document.file_name || '';\r\n        bot.sendMessage(chatId, `ðŸ“¥ Ð¤Ð°Ð¹Ð» Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½: ${msg.document.file_name}\\nðŸ”— Ð¡ÑÑ‹Ð»ÐºÐ°: \\`${fileLink}\\``, { parse_mode: 'Markdown' });\r\n      } catch (error) {\r\n        bot.sendMessage(chatId, 'âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ð¸ Ñ„Ð°Ð¹Ð»Ð°. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ ÑÑÑ‹Ð»ÐºÑƒ Ð²Ð¼ÐµÑÑ‚Ð¾ Ñ„Ð°Ð¹Ð»Ð°.');\r\n        return;\r\n      }\r\n    } else if (text) {\r\n      // User sent a text link\r\n      linkToSave = text;\r\n    } else {\r\n      return;\r\n    }\r\n\r\n    const links = readPlatformLinks();\r\n    if (!links[state.platform]) {\r\n      links[state.platform] = { web: '', ios: '', android: '' };\r\n    }\r\n\r\n    links[state.platform][state.editType] = linkToSave;\r\n\r\n    // Save file name for Android APK\r\n    if (state.editType === 'android' && fileName) {\r\n      links[state.platform].androidFileName = fileName;\r\n    }\r\n\r\n    if (writePlatformLinks(links)) {\r\n      const names = { web: 'Web', ios: 'iOS', android: 'Android APK' };\r\n      bot.sendMessage(chatId,\r\n        `âœ… *${names[state.editType]} Ð´Ð»Ñ ${state.platform} ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð°!*\\n\\n\\`${linkToSave}\\``,\r\n        { parse_mode: 'Markdown', reply_markup: getPlatformEditMenu(state.platform) }\r\n      );\r\n    } else {\r\n      bot.sendMessage(chatId, 'âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ð¸.');\r\n    }\r\n\r\n    delete userState[userId];\r\n  });\r\n\r\n  return bot;\r\n}\r\n","import \"dotenv/config\";\nimport express from \"express\";\nimport cors from \"cors\";\nimport { handleDemo } from \"./routes/demo\";\nimport platformsRouter from \"./routes/platforms\";\nimport { startTelegramBot } from \"./bot/telegram-bot\";\n\nexport function createServer() {\n  const app = express();\n\n  // Middleware\n  app.use(cors());\n  app.use(express.json());\n  app.use(express.urlencoded({ extended: true }));\n\n  // Example API routes\n  app.get(\"/api/ping\", (_req, res) => {\n    const ping = process.env.PING_MESSAGE ?? \"ping\";\n    res.json({ message: ping });\n  });\n\n  app.get(\"/api/demo\", handleDemo);\n\n  // Platform links API\n  app.use(platformsRouter);\n\n  // Start Telegram Bot\n  try {\n    startTelegramBot();\n    console.log('âœ… Telegram bot initialization complete');\n  } catch (error) {\n    console.error('âŒ Failed to start Telegram bot:', error);\n  }\n\n  return app;\n}\n","import path from \"path\";\nimport { createServer } from \"./index\";\nimport * as express from \"express\";\n\nconst app = createServer();\nconst port = process.env.PORT || 3000;\n\n// In production, serve the built SPA files\nconst __dirname = import.meta.dirname;\nconst distPath = path.join(__dirname, \"../spa\");\n\n// Serve static files\napp.use(express.static(distPath));\n\n// Handle React Router - serve index.html for all non-API routes\napp.use((req, res) => {\n  // Don't serve index.html for API routes\n  if (req.path.startsWith(\"/api/\") || req.path.startsWith(\"/health\")) {\n    return res.status(404).json({ error: \"API endpoint not found\" });\n  }\n\n  res.sendFile(path.join(distPath, \"index.html\"));\n});\n\napp.listen(port, () => {\n  console.log(`ðŸš€ Fusion Starter server running on port ${port}`);\n  console.log(`ðŸ“± Frontend: http://localhost:${port}`);\n  console.log(`ðŸ”§ API: http://localhost:${port}/api`);\n});\n\n// Graceful shutdown\nprocess.on(\"SIGTERM\", () => {\n  console.log(\"ðŸ›‘ Received SIGTERM, shutting down gracefully\");\n  process.exit(0);\n});\n\nprocess.on(\"SIGINT\", () => {\n  console.log(\"ðŸ›‘ Received SIGINT, shutting down gracefully\");\n  process.exit(0);\n});\n"],"names":["DATA_FILE","ensureDataDir","readPlatformLinks","writePlatformLinks","app","express","platformsRouter"],"mappings":"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"}