{"version":3,"file":"node-build.mjs","sources":["../../server/routes/demo.ts","../../server/routes/platforms.ts","../../server/bot/telegram-bot.ts","../../server/index.ts","../../server/node-build.ts"],"sourcesContent":["import { RequestHandler } from \"express\";\nimport { DemoResponse } from \"@shared/api\";\n\nexport const handleDemo: RequestHandler = (req, res) => {\n  const response: DemoResponse = {\n    message: \"Hello from Express server\",\n  };\n  res.status(200).json(response);\n};\n","import { Router } from 'express';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\nimport https from 'https';\r\n\r\nconst router = Router();\r\n\r\n// Path to store platform links data\r\nconst DATA_FILE = path.join(process.cwd(), 'data', 'platform-links.json');\r\n\r\n// Ensure data directory exists\r\nfunction ensureDataDir() {\r\n  const dataDir = path.dirname(DATA_FILE);\r\n  if (!fs.existsSync(dataDir)) {\r\n    fs.mkdirSync(dataDir, { recursive: true });\r\n  }\r\n}\r\n\r\n// Read platform links from file\r\nfunction readPlatformLinks(): Record<string, { web: string; ios: string; android: string; androidFileName?: string }> {\r\n  ensureDataDir();\r\n  try {\r\n    if (fs.existsSync(DATA_FILE)) {\r\n      const data = fs.readFileSync(DATA_FILE, 'utf-8');\r\n      return JSON.parse(data);\r\n    }\r\n  } catch (error) {\r\n    console.error('Error reading platform links:', error);\r\n  }\r\n  return {};\r\n}\r\n\r\n// Write platform links to file\r\nfunction writePlatformLinks(data: Record<string, { web: string; ios: string; android: string; androidFileName?: string }>) {\r\n  ensureDataDir();\r\n  try {\r\n    fs.writeFileSync(DATA_FILE, JSON.stringify(data, null, 2), 'utf-8');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error writing platform links:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// GET all platform links\r\nrouter.get('/api/platform-links', (req, res) => {\r\n  const links = readPlatformLinks();\r\n  res.json(links);\r\n});\r\n\r\n// GET specific platform links\r\nrouter.get('/api/platform-links/:platformId', (req, res) => {\r\n  const links = readPlatformLinks();\r\n  const platformLinks = links[req.params.platformId];\r\n\r\n  if (platformLinks) {\r\n    res.json(platformLinks);\r\n  } else {\r\n    res.status(404).json({ error: 'Platform not found' });\r\n  }\r\n});\r\n\r\n// POST/PUT update platform links (requires admin authentication)\r\nrouter.post('/api/platform-links/:platformId', (req, res) => {\r\n  const { platformId } = req.params;\r\n  const { web, ios, android, adminKey } = req.body;\r\n\r\n  // Simple admin key check (you should use proper authentication)\r\n  const ADMIN_KEY = process.env.ADMIN_KEY || 'change-this-in-production';\r\n\r\n  if (adminKey !== ADMIN_KEY) {\r\n    return res.status(403).json({ error: 'Unauthorized' });\r\n  }\r\n\r\n  const links = readPlatformLinks();\r\n  links[platformId] = { web, ios, android };\r\n\r\n  if (writePlatformLinks(links)) {\r\n    res.json({ success: true, platformId, links: links[platformId] });\r\n  } else {\r\n    res.status(500).json({ error: 'Failed to update platform links' });\r\n  }\r\n});\r\n\r\n// DELETE platform links (requires admin authentication)\r\nrouter.delete('/api/platform-links/:platformId', (req, res) => {\r\n  const { platformId } = req.params;\r\n  const { adminKey } = req.body;\r\n\r\n  const ADMIN_KEY = process.env.ADMIN_KEY || 'change-this-in-production';\r\n\r\n  if (adminKey !== ADMIN_KEY) {\r\n    return res.status(403).json({ error: 'Unauthorized' });\r\n  }\r\n\r\n  const links = readPlatformLinks();\r\n\r\n  if (links[platformId]) {\r\n    delete links[platformId];\r\n\r\n    if (writePlatformLinks(links)) {\r\n      res.json({ success: true, platformId });\r\n    } else {\r\n      res.status(500).json({ error: 'Failed to delete platform links' });\r\n    }\r\n  } else {\r\n    res.status(404).json({ error: 'Platform not found' });\r\n  }\r\n});\r\n\r\n// Proxy endpoint for downloading APK files with correct filename\r\nrouter.get('/api/download-apk/:platformId', (req, res) => {\r\n  const { platformId } = req.params;\r\n  const links = readPlatformLinks();\r\n  const platformData = links[platformId];\r\n\r\n  if (!platformData || !platformData.android) {\r\n    return res.status(404).json({ error: 'APK not found' });\r\n  }\r\n\r\n  const apkUrl = platformData.android;\r\n  const fileName = platformData.androidFileName || `${platformId}.apk`;\r\n\r\n  // Set headers for file download\r\n  res.setHeader('Content-Disposition', `attachment; filename=\"${fileName}\"`);\r\n  res.setHeader('Content-Type', 'application/vnd.android.package-archive');\r\n\r\n  // Proxy the file from Telegram\r\n  https.get(apkUrl, (fileStream) => {\r\n    fileStream.pipe(res);\r\n  }).on('error', (error) => {\r\n    console.error('Error downloading APK:', error);\r\n    res.status(500).json({ error: 'Failed to download APK' });\r\n  });\r\n});\r\n\r\nexport default router;\r\n","import TelegramBot from 'node-telegram-bot-api';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\n// Configuration\r\nconst BOT_TOKEN = process.env.TELEGRAM_BOT_TOKEN || '';\r\nconst ADMIN_USERS = (process.env.TELEGRAM_ADMIN_IDS || '').split(',').map(id => parseInt(id.trim()));\r\n\r\n// Data file path\r\nconst DATA_FILE = path.join(process.cwd(), 'data', 'platform-links.json');\r\n\r\n// Ensure data directory exists\r\nfunction ensureDataDir() {\r\n  const dataDir = path.dirname(DATA_FILE);\r\n  if (!fs.existsSync(dataDir)) {\r\n    fs.mkdirSync(dataDir, { recursive: true });\r\n  }\r\n}\r\n\r\n// Read platform links\r\nfunction readPlatformLinks(): Record<string, { web: string; ios: string; android: string; androidFileName?: string }> {\r\n  ensureDataDir();\r\n  try {\r\n    if (fs.existsSync(DATA_FILE)) {\r\n      const data = fs.readFileSync(DATA_FILE, 'utf-8');\r\n      return JSON.parse(data);\r\n    }\r\n  } catch (error) {\r\n    console.error('Error reading platform links:', error);\r\n  }\r\n  return {};\r\n}\r\n\r\n// Write platform links\r\nfunction writePlatformLinks(data: Record<string, { web: string; ios: string; android: string; androidFileName?: string }>) {\r\n  ensureDataDir();\r\n  try {\r\n    fs.writeFileSync(DATA_FILE, JSON.stringify(data, null, 2), 'utf-8');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error writing platform links:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Check if user is admin\r\nfunction isAdmin(userId: number): boolean {\r\n  return ADMIN_USERS.includes(userId);\r\n}\r\n\r\n// Platform names\r\nconst PLATFORMS = [\r\n  '1xbet', 'melbet', 'linebet', '888starz', '1xcasino', 'dbbet',\r\n  'winwin', 'mostbet', 'xparibet', 'betwinner', 'megapari', 'coldbet',\r\n  'ultrapari', 'fastpari', 'spinbetter', 'yohohobet', 'luckypari'\r\n];\r\n\r\n// Translations\r\nconst translations = {\r\n  ru: {\r\n    welcome: 'üëã *–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ LinkZone Admin Bot!*\\n\\n–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫:',\r\n    welcomeAdmin: 'üîê –í—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä.\\n\\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:',\r\n    noAccess: '‚ö†Ô∏è –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.',\r\n    chooseAction: '*LinkZone Admin Bot*\\n\\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:',\r\n    showAll: 'üìã –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Å—Å—ã–ª–∫–∏',\r\n    manage: '‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∞–º–∏',\r\n    delete: 'üóë –£–¥–∞–ª–∏—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—É',\r\n    platforms: 'üé∞ –°–ø–∏—Å–æ–∫ –ø–ª–∞—Ç—Ñ–æ—Ä–º',\r\n    language: 'üåê –Ø–∑—ã–∫',\r\n    back: '‚óÄÔ∏è –ù–∞–∑–∞–¥',\r\n    currentLinks: 'üìã *–¢–µ–∫—É—â–∏–µ —Å—Å—ã–ª–∫–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º:*\\n\\n',\r\n    noLinks: 'üì≠ –ù–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Å—Å—ã–ª–æ–∫.',\r\n    availablePlatforms: 'üé∞ *–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:*\\n\\n',\r\n    manageLinks: '‚öôÔ∏è *–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∞–º–∏*\\n\\n–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É:',\r\n    deletePlatform: 'üóë *–£–¥–∞–ª–∏—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—É*\\n\\n–í—ã–±–µ—Ä–∏—Ç–µ:',\r\n    setWeb: 'üåê –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Web',\r\n    setIos: 'üçé –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å iOS',\r\n    setAndroid: 'ü§ñ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Android APK',\r\n    showCurrent: 'üìã –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ',\r\n    sendWebLink: 'üåê *Web —Å—Å—ã–ª–∫–∞ –¥–ª—è {platform}*\\n\\n–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É:',\r\n    sendIosLink: 'üçé *iOS —Å—Å—ã–ª–∫–∞ –¥–ª—è {platform}*\\n\\n–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É:',\r\n    sendAndroidLink: 'ü§ñ *Android APK –¥–ª—è {platform}*\\n\\n–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ APK:',\r\n    cancel: '‚ùå –û—Ç–º–µ–Ω–∞',\r\n    platformDeleted: '‚úÖ –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ *{platform}* —É–¥–∞–ª–µ–Ω–∞!',\r\n    fileReceived: 'üì• –§–∞–π–ª –ø–æ–ª—É—á–µ–Ω: {filename}\\nüîó –°—Å—ã–ª–∫–∞: `{link}`',\r\n    fileError: '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –≤–º–µ—Å—Ç–æ —Ñ–∞–π–ª–∞.',\r\n    linkSaved: '‚úÖ *{type} –¥–ª—è {platform} —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!*\\n\\n`{link}`',\r\n    saveError: '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏.',\r\n    notSet: '‚ùå –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ',\r\n    accessDenied: '‚õî –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω',\r\n    languageChanged: '‚úÖ –Ø–∑—ã–∫ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ –†—É—Å—Å–∫–∏–π'\r\n  },\r\n  uz: {\r\n    welcome: 'üëã *LinkZone Admin Botiga xush kelibsiz!*\\n\\nTilni tanlang:',\r\n    welcomeAdmin: 'üîê Siz administrator sifatida avtorizatsiya qilindingiz.\\n\\nAmalni tanlang:',\r\n    noAccess: '‚ö†Ô∏è Sizda administrator huquqlari yo\\'q.',\r\n    chooseAction: '*LinkZone Admin Bot*\\n\\nAmalni tanlang:',\r\n    showAll: 'üìã Barcha havolalarni ko\\'rsatish',\r\n    manage: '‚öôÔ∏è Havolalarni boshqarish',\r\n    delete: 'üóë Platformani o\\'chirish',\r\n    platforms: 'üé∞ Platformalar ro\\'yxati',\r\n    language: 'üåê Til',\r\n    back: '‚óÄÔ∏è Orqaga',\r\n    currentLinks: 'üìã *Joriy platform havolalari:*\\n\\n',\r\n    noLinks: 'üì≠ O\\'rnatilgan havolalar yo\\'q.',\r\n    availablePlatforms: 'üé∞ *Mavjud platformalar:*\\n\\n',\r\n    manageLinks: '‚öôÔ∏è *Havolalarni boshqarish*\\n\\nPlatformani tanlang:',\r\n    deletePlatform: 'üóë *Platformani o\\'chirish*\\n\\nTanlang:',\r\n    setWeb: 'üåê Web o\\'rnatish',\r\n    setIos: 'üçé iOS o\\'rnatish',\r\n    setAndroid: 'ü§ñ Android APK o\\'rnatish',\r\n    showCurrent: 'üìã Joriy ko\\'rsatish',\r\n    sendWebLink: 'üåê *{platform} uchun Web havola*\\n\\nHavolani yuboring:',\r\n    sendIosLink: 'üçé *{platform} uchun iOS havola*\\n\\nHavolani yuboring:',\r\n    sendAndroidLink: 'ü§ñ *{platform} uchun Android APK*\\n\\nAPK havolasini yuboring:',\r\n    cancel: '‚ùå Bekor qilish',\r\n    platformDeleted: '‚úÖ *{platform}* platformasi o\\'chirildi!',\r\n    fileReceived: 'üì• Fayl qabul qilindi: {filename}\\nüîó Havola: `{link}`',\r\n    fileError: '‚ùå Faylni olishda xatolik. Havola yuborishga harakat qiling.',\r\n    linkSaved: '‚úÖ *{platform} uchun {type} saqlandi!*\\n\\n`{link}`',\r\n    saveError: '‚ùå Saqlashda xatolik.',\r\n    notSet: '‚ùå o\\'rnatilmagan',\r\n    accessDenied: '‚õî Kirish taqiqlangan',\r\n    languageChanged: '‚úÖ Til O\\'zbekchaga o\\'zgartirildi'\r\n  }\r\n};\r\n\r\ntype Language = 'ru' | 'uz';\r\n\r\n// User language preferences\r\nconst userLanguages: Record<number, Language> = {};\r\n\r\n// Global bot instance to prevent duplicates\r\nlet botInstance: TelegramBot | null = null;\r\n\r\nexport function stopTelegramBot() {\r\n  if (botInstance) {\r\n    botInstance.stopPolling();\r\n    botInstance = null;\r\n    console.log('Telegram bot stopped');\r\n  }\r\n}\r\n\r\nexport function startTelegramBot() {\r\n  if (botInstance) {\r\n    console.log('Telegram bot already running, skipping initialization');\r\n    return botInstance;\r\n  }\r\n\r\n  if (!BOT_TOKEN || BOT_TOKEN === 'YOUR_NEW_BOT_TOKEN_HERE' || BOT_TOKEN.length < 20) {\r\n    console.warn('WARNING: Telegram bot disabled - Invalid or missing token');\r\n    console.warn('   Get a new token from @BotFather and update .env file');\r\n    return null;\r\n  }\r\n\r\n  const bot = new TelegramBot(BOT_TOKEN, { polling: false });\r\n\r\n  bot.deleteWebHook().then(() => {\r\n    console.log('Webhook deleted, starting polling...');\r\n    bot.startPolling({ restart: true });\r\n    botInstance = bot;\r\n    console.log('Telegram bot started successfully!');\r\n  }).catch(err => {\r\n    console.error('Error deleting webhook:', err);\r\n    bot.startPolling({ restart: true });\r\n    botInstance = bot;\r\n  });\r\n\r\n  bot.on('polling_error', (error) => {\r\n    console.error('Polling error:', error.code);\r\n    if (error.code === 'ETELEGRAM' && error.message.includes('409')) {\r\n      console.log('Conflict detected, stopping old instance...');\r\n      setTimeout(() => {\r\n        bot.stopPolling();\r\n        setTimeout(() => bot.startPolling({ restart: true }), 2000);\r\n      }, 1000);\r\n    }\r\n  });\r\n\r\n  // Helper function to get user language\r\n  const getLang = (userId: number): Language => userLanguages[userId] || 'ru';\r\n\r\n  // Helper function to translate text\r\n  const t = (userId: number, key: keyof typeof translations.ru, params?: Record<string, string>): string => {\r\n    const lang = getLang(userId);\r\n    let text = translations[lang][key];\r\n    if (params) {\r\n      Object.entries(params).forEach(([k, v]) => {\r\n        text = text.replace(new RegExp(`\\\\{${k}\\\\}`, 'g'), v);\r\n      });\r\n    }\r\n    return text;\r\n  };\r\n\r\n  const userState: Record<number, { platform?: string; editType?: 'web' | 'ios' | 'android' }> = {};\r\n\r\n  const getLanguageMenu = () => ({\r\n    inline_keyboard: [\r\n      [{ text: 'üá∑üá∫ –†—É—Å—Å–∫–∏–π', callback_data: 'lang_ru' }],\r\n      [{ text: 'üá∫üáø O\\'zbekcha', callback_data: 'lang_uz' }],\r\n    ]\r\n  });\r\n\r\n  const getMainMenu = (userId: number) => ({\r\n    inline_keyboard: [\r\n      [{ text: t(userId, 'showAll'), callback_data: 'action_list' }],\r\n      [{ text: t(userId, 'manage'), callback_data: 'action_manage' }],\r\n      [{ text: t(userId, 'delete'), callback_data: 'action_delete' }],\r\n      [{ text: t(userId, 'platforms'), callback_data: 'action_platforms' }],\r\n      [{ text: t(userId, 'language'), callback_data: 'action_language' }],\r\n    ]\r\n  });\r\n\r\n  const getPlatformKeyboard = (action: string, userId: number) => {\r\n    const keyboard: any[][] = [];\r\n    for (let i = 0; i < PLATFORMS.length; i += 3) {\r\n      const row = PLATFORMS.slice(i, i + 3).map(platform => ({\r\n        text: platform,\r\n        callback_data: `${action}_${platform}`\r\n      }));\r\n      keyboard.push(row);\r\n    }\r\n    keyboard.push([{ text: t(userId, 'back'), callback_data: 'back_main' }]);\r\n    return { inline_keyboard: keyboard };\r\n  };\r\n\r\n  const getPlatformEditMenu = (platform: string, userId: number) => {\r\n    return {\r\n      inline_keyboard: [\r\n        [{ text: t(userId, 'setWeb'), callback_data: `edit_web_${platform}` }],\r\n        [{ text: t(userId, 'setIos'), callback_data: `edit_ios_${platform}` }],\r\n        [{ text: t(userId, 'setAndroid'), callback_data: `edit_android_${platform}` }],\r\n        [{ text: t(userId, 'showCurrent'), callback_data: `show_${platform}` }],\r\n        [{ text: t(userId, 'back'), callback_data: 'action_manage' }],\r\n      ]\r\n    };\r\n  };\r\n\r\n  bot.onText(/\\/start/, (msg) => {\r\n    const chatId = msg.chat.id;\r\n    const userId = msg.from?.id || 0;\r\n\r\n    if (!isAdmin(userId)) {\r\n      bot.sendMessage(chatId, t(userId, 'welcome'), {\r\n        parse_mode: 'Markdown',\r\n        reply_markup: getLanguageMenu()\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (!userLanguages[userId]) {\r\n      bot.sendMessage(chatId, t(userId, 'welcome'), {\r\n        parse_mode: 'Markdown',\r\n        reply_markup: getLanguageMenu()\r\n      });\r\n    } else {\r\n      bot.sendMessage(chatId, t(userId, 'welcomeAdmin'), {\r\n        parse_mode: 'Markdown',\r\n        reply_markup: getMainMenu(userId)\r\n      });\r\n    }\r\n  });\r\n\r\n  bot.on('callback_query', async (query) => {\r\n    const chatId = query.message!.chat.id;\r\n    const userId = query.from.id;\r\n    const data = query.data!;\r\n    const messageId = query.message!.message_id;\r\n\r\n    // Language selection\r\n    if (data.startsWith('lang_')) {\r\n      const lang = data.replace('lang_', '') as Language;\r\n      userLanguages[userId] = lang;\r\n\r\n      if (!isAdmin(userId)) {\r\n        bot.editMessageText(t(userId, 'noAccess'), {\r\n          chat_id: chatId, message_id: messageId, parse_mode: 'Markdown'\r\n        });\r\n        bot.answerCallbackQuery(query.id);\r\n        return;\r\n      }\r\n\r\n      bot.editMessageText(t(userId, 'welcomeAdmin'), {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: getMainMenu(userId)\r\n      });\r\n      bot.answerCallbackQuery(query.id, { text: t(userId, 'languageChanged') });\r\n      return;\r\n    }\r\n\r\n    if (!isAdmin(userId)) {\r\n      bot.answerCallbackQuery(query.id, { text: t(userId, 'accessDenied'), show_alert: true });\r\n      return;\r\n    }\r\n\r\n    if (data === 'action_language') {\r\n      bot.editMessageText(t(userId, 'welcome'), {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: getLanguageMenu()\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data === 'action_list') {\r\n      const links = readPlatformLinks();\r\n      let message = t(userId, 'currentLinks');\r\n      if (Object.keys(links).length === 0) {\r\n        message = t(userId, 'noLinks');\r\n      } else {\r\n        for (const [platform, urls] of Object.entries(links)) {\r\n          message += `*${platform.toUpperCase()}*\\n`;\r\n          message += `üåê Web: ${urls.web || t(userId, 'notSet')}\\n`;\r\n          message += `üçé iOS: ${urls.ios || t(userId, 'notSet')}\\n`;\r\n          message += `ü§ñ Android: ${urls.android || t(userId, 'notSet')}\\n\\n`;\r\n        }\r\n      }\r\n      bot.editMessageText(message, {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: { inline_keyboard: [[{ text: t(userId, 'back'), callback_data: 'back_main' }]] }\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data === 'action_platforms') {\r\n      let message = t(userId, 'availablePlatforms');\r\n      PLATFORMS.forEach((p, i) => message += `${i + 1}. ${p}\\n`);\r\n      bot.editMessageText(message, {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: { inline_keyboard: [[{ text: t(userId, 'back'), callback_data: 'back_main' }]] }\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data === 'action_manage') {\r\n      bot.editMessageText(t(userId, 'manageLinks'), {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: getPlatformKeyboard('manage', userId)\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data === 'action_delete') {\r\n      bot.editMessageText(t(userId, 'deletePlatform'), {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: getPlatformKeyboard('delete', userId)\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data === 'back_main') {\r\n      delete userState[userId];\r\n      bot.editMessageText(t(userId, 'chooseAction'), {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: getMainMenu(userId)\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data.startsWith('manage_')) {\r\n      const platform = data.replace('manage_', '');\r\n      const links = readPlatformLinks();\r\n      const pl = links[platform] || { web: '', ios: '', android: '' };\r\n\r\n      let message = `‚öôÔ∏è *${t(userId, 'manage')}: ${platform.toUpperCase()}*\\n\\n`;\r\n      message += `üåê Web: ${pl.web || t(userId, 'notSet')}\\n`;\r\n      message += `üçé iOS: ${pl.ios || t(userId, 'notSet')}\\n`;\r\n      message += `ü§ñ Android: ${pl.android || t(userId, 'notSet')}\\n`;\r\n\r\n      bot.editMessageText(message, {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: getPlatformEditMenu(platform, userId)\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data.startsWith('show_')) {\r\n      const platform = data.replace('show_', '');\r\n      const links = readPlatformLinks();\r\n      const pl = links[platform] || { web: '', ios: '', android: '' };\r\n\r\n      let message = `üìã *${platform.toUpperCase()}*\\n\\n`;\r\n      message += `üåê Web:\\n\\`${pl.web || t(userId, 'notSet')}\\`\\n\\n`;\r\n      message += `üçé iOS:\\n\\`${pl.ios || t(userId, 'notSet')}\\`\\n\\n`;\r\n      message += `ü§ñ Android:\\n\\`${pl.android || t(userId, 'notSet')}\\``;\r\n\r\n      bot.editMessageText(message, {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: { inline_keyboard: [[{ text: t(userId, 'back'), callback_data: `manage_${platform}` }]] }\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data.startsWith('edit_web_')) {\r\n      const platform = data.replace('edit_web_', '');\r\n      userState[userId] = { platform, editType: 'web' };\r\n      bot.editMessageText(t(userId, 'sendWebLink', { platform: platform.toUpperCase() }), {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: { inline_keyboard: [[{ text: t(userId, 'cancel'), callback_data: `manage_${platform}` }]] }\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data.startsWith('edit_ios_')) {\r\n      const platform = data.replace('edit_ios_', '');\r\n      userState[userId] = { platform, editType: 'ios' };\r\n      bot.editMessageText(t(userId, 'sendIosLink', { platform: platform.toUpperCase() }), {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: { inline_keyboard: [[{ text: t(userId, 'cancel'), callback_data: `manage_${platform}` }]] }\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data.startsWith('edit_android_')) {\r\n      const platform = data.replace('edit_android_', '');\r\n      userState[userId] = { platform, editType: 'android' };\r\n      bot.editMessageText(t(userId, 'sendAndroidLink', { platform: platform.toUpperCase() }), {\r\n        chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n        reply_markup: { inline_keyboard: [[{ text: t(userId, 'cancel'), callback_data: `manage_${platform}` }]] }\r\n      });\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n\r\n    else if (data.startsWith('delete_')) {\r\n      const platform = data.replace('delete_', '');\r\n      const links = readPlatformLinks();\r\n      if (links[platform]) {\r\n        delete links[platform];\r\n        if (writePlatformLinks(links)) {\r\n          bot.editMessageText(t(userId, 'platformDeleted', { platform }), {\r\n            chat_id: chatId, message_id: messageId, parse_mode: 'Markdown',\r\n            reply_markup: { inline_keyboard: [[{ text: t(userId, 'back'), callback_data: 'back_main' }]] }\r\n          });\r\n        }\r\n      }\r\n      bot.answerCallbackQuery(query.id);\r\n    }\r\n  });\r\n\r\n  bot.on('message', async (msg) => {\r\n    const chatId = msg.chat.id;\r\n    const userId = msg.from?.id || 0;\r\n    const text = msg.text || '';\r\n\r\n    if (text.startsWith('/')) return;\r\n\r\n    const state = userState[userId];\r\n    if (!state || !state.platform || !state.editType) return;\r\n\r\n    let linkToSave = '';\r\n    let fileName = '';\r\n\r\n    if (msg.document) {\r\n      try {\r\n        const fileLink = await bot.getFileLink(msg.document.file_id);\r\n        linkToSave = fileLink;\r\n        fileName = msg.document.file_name || '';\r\n        bot.sendMessage(chatId, t(userId, 'fileReceived', { filename: msg.document.file_name || '', link: fileLink }), { parse_mode: 'Markdown' });\r\n      } catch (error) {\r\n        bot.sendMessage(chatId, t(userId, 'fileError'));\r\n        return;\r\n      }\r\n    } else if (text) {\r\n      linkToSave = text;\r\n    } else {\r\n      return;\r\n    }\r\n\r\n    const links = readPlatformLinks();\r\n    if (!links[state.platform]) {\r\n      links[state.platform] = { web: '', ios: '', android: '' };\r\n    }\r\n\r\n    links[state.platform][state.editType] = linkToSave;\r\n\r\n    if (state.editType === 'android' && fileName) {\r\n      links[state.platform].androidFileName = fileName;\r\n    }\r\n\r\n    if (writePlatformLinks(links)) {\r\n      const names = { web: 'Web', ios: 'iOS', android: 'Android APK' };\r\n      bot.sendMessage(chatId,\r\n        t(userId, 'linkSaved', { type: names[state.editType], platform: state.platform, link: linkToSave }),\r\n        { parse_mode: 'Markdown', reply_markup: getPlatformEditMenu(state.platform, userId) }\r\n      );\r\n    } else {\r\n      bot.sendMessage(chatId, t(userId, 'saveError'));\r\n    }\r\n\r\n    delete userState[userId];\r\n  });\r\n\r\n  return bot;\r\n}\r\n","import \"dotenv/config\";\nimport express from \"express\";\nimport cors from \"cors\";\nimport { handleDemo } from \"./routes/demo\";\nimport platformsRouter from \"./routes/platforms\";\nimport { startTelegramBot } from \"./bot/telegram-bot\";\n\nexport function createServer() {\n  const app = express();\n\n  // Middleware\n  app.use(cors());\n  app.use(express.json());\n  app.use(express.urlencoded({ extended: true }));\n\n  // Example API routes\n  app.get(\"/api/ping\", (_req, res) => {\n    const ping = process.env.PING_MESSAGE ?? \"ping\";\n    res.json({ message: ping });\n  });\n\n  app.get(\"/api/demo\", handleDemo);\n\n  // Platform links API\n  app.use(platformsRouter);\n\n  // Start Telegram Bot\n  try {\n    startTelegramBot();\n    console.log('‚úÖ Telegram bot initialization complete');\n  } catch (error) {\n    console.error('‚ùå Failed to start Telegram bot:', error);\n  }\n\n  return app;\n}\n","import path from \"path\";\nimport { createServer } from \"./index\";\nimport * as express from \"express\";\n\nconst app = createServer();\nconst port = process.env.PORT || 3000;\n\n// In production, serve the built SPA files\nconst __dirname = import.meta.dirname;\nconst distPath = path.join(__dirname, \"../spa\");\n\n// Serve static files\napp.use(express.static(distPath));\n\n// Handle React Router - serve index.html for all non-API routes\napp.use((req, res) => {\n  // Don't serve index.html for API routes\n  if (req.path.startsWith(\"/api/\") || req.path.startsWith(\"/health\")) {\n    return res.status(404).json({ error: \"API endpoint not found\" });\n  }\n\n  res.sendFile(path.join(distPath, \"index.html\"));\n});\n\napp.listen(port, () => {\n  console.log(`üöÄ Fusion Starter server running on port ${port}`);\n  console.log(`üì± Frontend: http://localhost:${port}`);\n  console.log(`üîß API: http://localhost:${port}/api`);\n});\n\n// Graceful shutdown\nprocess.on(\"SIGTERM\", () => {\n  console.log(\"üõë Received SIGTERM, shutting down gracefully\");\n  process.exit(0);\n});\n\nprocess.on(\"SIGINT\", () => {\n  console.log(\"üõë Received SIGINT, shutting down gracefully\");\n  process.exit(0);\n});\n"],"names":["DATA_FILE","ensureDataDir","readPlatformLinks","writePlatformLinks","app","express","platformsRouter"],"mappings":"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"}